/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.27
 * Generated at: 2015-01-20 02:54:53 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.setup;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class index_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      org.opencms.setup.CmsSetupBean Bean = null;
      synchronized (session) {
        Bean = (org.opencms.setup.CmsSetupBean) _jspx_page_context.getAttribute("Bean", javax.servlet.jsp.PageContext.SESSION_SCOPE);
        if (Bean == null){
          Bean = new org.opencms.setup.CmsSetupBean();
          _jspx_page_context.setAttribute("Bean", Bean, javax.servlet.jsp.PageContext.SESSION_SCOPE);
        }
      }
      org.apache.jasper.runtime.JspRuntimeLibrary.introspect(_jspx_page_context.findAttribute("Bean"), request);


// next page 
String nextPage = "step_2_check_components.jsp";

boolean isInitialized = false;
boolean wizardEnabled = false;
boolean showButtons = false;

try {
	if (Bean.isInitialized()) {
		session.invalidate();
		response.sendRedirect("index.jsp");
	}
	
	// Initialize the Bean 
	Bean.init(pageContext);

	// check wizards accessability 
	wizardEnabled = Bean.getWizardEnabled();
	
	if (!wizardEnabled) {
		request.getSession().invalidate();
	}	

	isInitialized = true;
} catch (Exception e) {
	// the servlet container did not unpack the war, so lets display an error message
}

      out.write('\n');
      out.write('\n');
      out.write('\n');
      out.print( Bean.getHtmlPart("C_HTML_START") );
      out.write("\n");
      out.write("Alkacon OpenCms Setup Wizard\n");
      out.print( Bean.getHtmlPart("C_HEAD_START") );
      out.write('\n');
      out.print( Bean.getHtmlPart("C_STYLES") );
      out.write('\n');
      out.print( Bean.getHtmlPart("C_STYLES_SETUP") );
      out.write("\n");
      out.write("<script type=\"text/javascript\">\n");
      out.write("\tfunction toggleButton(theFlag) {\n");
      out.write("\t\tdocument.getElementById(\"continue\").disabled = theFlag;\n");
      out.write("\t}\t\n");
      out.write("</script>\n");
      out.print( Bean.getHtmlPart("C_HEAD_END") );
      out.write("\n");
      out.write("Alkacon OpenCms Setup Wizard - License Agreement\n");
      out.print( Bean.getHtmlPart("C_CONTENT_SETUP_START") );
      out.write("\n");
      out.write("<form action=\"");
      out.print( nextPage );
      out.write("\" method=\"post\" class=\"nomargin\">\n");
      out.write("\n");
      out.write("<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; height: 100%; padding-right: 3px;\">\n");
      out.write("\t");
 if (wizardEnabled && isInitialized)	{ 
		showButtons = true; 
      out.write("\n");
      out.write("\t\t<tr>\n");
      out.write("\t\t\t<td style=\"vertical-align: top;\">\n");
      out.write("\t\t\t\t<div class=\"dialoginnerboxborder\"><div class=\"dialoginnerbox\">\t\n");
      out.write("\t\t\t\t<iframe src=\"license.html\" name=\"license\" style=\"width: 100%; height: 310px; margin: 0; padding: 0; border-style: none;\" frameborder=\"0\"></iframe>\n");
      out.write("\t\t\t\t</div></div>\n");
      out.write("\t\t\t</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t<tr>\n");
      out.write("\t\t\t<td style=\"vertical-align: bottom;padding-top: 12px;\">\n");
      out.write("\t\t\t\t<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align: bottom; height: 20px;\">\n");
      out.write("\t\t\t\t<tr>\n");
      out.write("\t\t\t\t\t<td>Do you accept all the terms of the preceding license agreement?</td>\n");
      out.write("\t\t\t\t\t<td>&nbsp;&nbsp;</td>\n");
      out.write("\t\t\t\t\t<td style=\"width: 25px;\"><input type=\"radio\" name=\"agree\" value=\"yes\" onclick=\"toggleButton(false);\"></td>\n");
      out.write("\t\t\t\t\t<td> yes</td>\n");
      out.write("\t\t\t\t\t<td>&nbsp;&nbsp;</td>\n");
      out.write("\t\t\t\t\t<td style=\"width: 25px;\"><input type=\"radio\" name=\"agree\" value=\"no\" onclick=\"toggleButton(true);\" checked=\"checked\"></td>\n");
      out.write("\t\t\t\t\t<td> no</td>\n");
      out.write("\t\t\t\t</tr>\n");
      out.write("\t\t\n");
      out.write("\t\t\t\t</table>\n");
      out.write("\t\t\t</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t");
 } else if (! isInitialized) { 
      out.write("\n");
      out.write("\t\t<tr>\n");
      out.write("\t\t\t<td style=\"vertical-align: middle;\">\n");
      out.write("\t\t\t\t");
      out.print( Bean.getHtmlPart("C_BLOCK_START", "Error starting wizard") );
      out.write("\n");
      out.write("\t\t\t\t<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n");
      out.write("\t\t\t\t\t<tr>\n");
      out.write("\t\t\t\t\t\t<td><img src=\"resources/error.png\" border=\"0\"></td>\n");
      out.write("\t\t\t\t\t\t<td>&nbsp;&nbsp;</td>\n");
      out.write("\t\t\t\t\t\t<td>\n");
      out.write("\t\t\t\t\t\t\tError starting Alkacon OpenCms setup wizard.<br>\n");
      out.write("\t\t\t\t\t\t\tIt appears that your servlet container did not unpack the Alkacon OpenCms WAR file.\n");
      out.write("\t\t\t\t\t\t\tAlkacon OpenCms requires that it's WAR file is unpacked.\n");
      out.write("\t\t\t\t\t\t\t<br><br>\n");
      out.write("\t\t\t\t\t\t\t<b>Please unpack the Alkacon OpenCms WAR file and try again.</b>\n");
      out.write("\t\t\t\t\t\t\t<br><br>\n");
      out.write("\t\t\t\t\t\t\tCheck out the documentation of your Servlet container to learn how to unpack the WAR file,\n");
      out.write("\t\t\t\t\t\t\tor do it manually with some kind of unzip - tool.\n");
      out.write("\t\t\t\t\t\t\t<br><br>\n");
      out.write("\t\t\t\t\t\t\tTip for Tomcat users:<br>\n");
      out.write("\t\t\t\t\t\t\tOpen the file <code>{tomcat-home}/conf/server.xml</code> and search\n");
      out.write("\t\t\t\t\t\t\tfor <code>unpackWARs=\"false\"</code>. Replace this with <code>unpackWARs=\"true\"</code>.\n");
      out.write("\t\t\t\t\t\t\tThen restart Tomcat.\n");
      out.write("\t\t\t\t\t\t</td>\n");
      out.write("\t\t\t\t\t</tr>\n");
      out.write("\t\t\t\t</table>\n");
      out.write("\t\t\t\t");
      out.print( Bean.getHtmlPart("C_BLOCK_END") );
      out.write("\n");
      out.write("\t\t\t</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t");
 } else { 
      out.write("\n");
      out.write("\t\t<tr>\n");
      out.write("\t\t\t<td style=\"vertical-align: middle; height: 100%;\">\n");
      out.write("\t\t\t\t");
      out.print( Bean.getHtmlPart("C_BLOCK_START", "Wizard locked") );
      out.write("\n");
      out.write("\t\t\t\t<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n");
      out.write("\t\t\t\t\t<tr>\n");
      out.write("\t\t\t\t\t\t<td><img src=\"resources/error.png\" border=\"0\"></td>\n");
      out.write("\t\t\t\t\t\t<td>&nbsp;&nbsp;</td>\n");
      out.write("\t\t\t\t\t\t<td style=\"width: 100%;\">\n");
      out.write("\t\t\t\t\t\t\tThe Alkacon OpenCms setup wizard is not available!<br>\n");
      out.write("\t\t\t\t\t\t\tTo enable the wizard, unlock it in \"opencms.properties\".\n");
      out.write("\t\t\t\t\t\t</td>\n");
      out.write("\t\t\t\t\t</tr>\n");
      out.write("\t\t\t\t</table>\n");
      out.write("\t\t\t\t");
      out.print( Bean.getHtmlPart("C_BLOCK_END") );
      out.write("\n");
      out.write("\t\t\t</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t");
 } 
      out.write("\n");
      out.write("\n");
      out.write("</table>\n");
      out.write("\n");
      out.print( Bean.getHtmlPart("C_CONTENT_END") );
      out.write('\n');
      out.write('\n');
 if (showButtons) { 
      out.write('\n');
      out.print( Bean.getHtmlPart("C_BUTTONS_START") );
      out.write("\n");
      out.write("<input name=\"back\" type=\"button\" value=\"&#060;&#060; Back\" class=\"dialogbutton\" style=\"visibility: hidden;\" disabled=\"disabled\">\n");
      out.write("<input name=\"continue\" id=\"continue\" type=\"submit\" value=\"Continue &#062;&#062;\" class=\"dialogbutton\">\n");
      out.write("<input name=\"cancel\" type=\"button\" value=\"Cancel\" class=\"dialogbutton\" style=\"margin-left: 50px; visibility: hidden;\" disabled=\"disabled\">\n");
      out.write("</form>\n");
      out.print( Bean.getHtmlPart("C_BUTTONS_END") );
      out.write("\n");
      out.write("<script type=\"text/javascript\">\n");
      out.write("\ttoggleButton(true);\n");
      out.write("</script>\n");
 } 
      out.write('\n');
      out.print( Bean.getHtmlPart("C_HTML_END") );
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
